---
sshd_banner_enable: 'false'
sshd_config:
  PermitRootLogin: 'yes'
  UseDNS: 'no'
ntp_config_server : ['0.freebsd.pool.ntp.org' , '1.freebsd.pool.ntp.org', '2.freebsd.pool.ntp.org']
ntp_mode: 'server'
resolv_nameservers:
  - 172.31.2.129
  - 172.31.2.130
resolv_domain: home
pf_role_enable: True
pf_ftpproxy_enable: True
pf_file_content: |
  # ansible managed - do not edit this file from here !
  set skip on lo

  set state-defaults pflow

  block return    # block stateless traffic
  pass            # establish keep-state

  # By default, do not permit remote connections to X11
  block return in on ! lo0 proto tcp to port 6000:6010

pf_ip_forward_enable: True

zone_home:
  name: "home"
  records:
    - { name: "" , type: "NS" , rdata: "fw-gw.home." }
    - { name: "fw-gw" , type: "A" , rdata: "172.31.2.131" }
zone_172_31_2_rev:
  name: "2.31.172.in-addr.arpa"
  records:
    - { name: "" , type: "NS" , rdata: "fw-gw.home." }
    - { name: "131", type: "PTR" , rdata: "fw-gw.home." }
zone_172_30_0_rev:
  name: "0.30.172.in-addr.arpa"
  records:
    - { name: "" , type: "NS" , rdata: "fw-gw.home." }
zone_172_30_1_rev:
  name: "0.30.172.in-addr.arpa"
  records:
    - { name: "" , type: "NS" , rdata: "fw-gw.home." }
zone_172_31_1_static_rev:
  name: "static.1.31.172.in-addr.arpa"
  records:
    - { name: "" , type: "NS" , rdata: "fw-gw.home." }
zone_172_31_1_rev:
  name: "1.31.172.in-addr.arpa"
  records:
    - { name: "" , type: NS , rdata: dns1.home. }
    - { name: "$GENERATE 1-63 $" ,type: CNAME , rdata: "$.static.1.31.172.in-addr.arpa." }
    - { name: "$GENERATE 64-96 $" ,type: CNAME , rdata: "$.1.31.172.dhcp.1.31.172.in-addr.arpa." }
    - { name: "$GENERATE 97-209 $" ,type: CNAME , rdata: "$.static.1.31.172.in-addr.arpa." }
    - { name: "$GENERATE 210-240 $" ,type: CNAME, rdata: "$.1.31.172.dhcp.1.31.172.in-addr.arpa." }
    - { name: "$GENERATE 241-254 $" ,type: CNAME , rdata: "$.static.1.31.172.in-addr.arpa." }

zone_rzp_static_dhcp:
    name: "rzp-static-dhcp"
    records:
      - { name: "" , type: "NS" , rdata: "fw-gw.home." }
      - { name: "$ORIGIN {{ zone_home.name }}" }
      - { name: "$INCLUDE {{ bind_config_master_zones_path }}/{{ zone_home.name }}_ansible_include" }
      - { name: "*" , type: CNAME , rdata: "*.dhcp." }
bind_zone_loopback_v6_enable: False
bind_dns_fqdn_name: "{{ ansible_host }}"
bind_hostmaster_name: hostmaster.home
bind_acls: 
  - name: goodclients
    addr_list: ['172.16.0.0/16' ,'127.0.0.1','10.0.0.0/8','192.168.0.0/16']
bind_options_allow_recursion: ['goodclients']
bind_options_allow_query: ['goodclients']
bind_options_additionals:
  - 'response-policy { zone "rzp-static-dhcp"; }'
bind_logging_channels:
   - name: default
     out: syslog daemon
     severity: info
   - name: update_log
     severity: "info"
     file: 
       name: "logs/update.log"
       version: 5
       size: "3M"
     print_time: yes
     print_category: yes
     print_severity: yes
   - name: test_log
     file:
       name: "logs/test.log"
bind_logging_categories:
   - name: default
     channels: [ 'default']
   - name: update
     channels: [ 'update_log' ]
bind_keys:
  - key:  "ddns-key"
    algorithm: 'hmac-md5'
    secret: "{{ vault_ddns_key_secret }}"
  - key:  "foreman-key"
    algorithm: 'hmac-md5'
    secret: "{{ vault_foreman_key_secret }}"
bind_zones:
   zone_home_dhcp:
     name: 'home.dhcp'
     type: master
     dynamic: true
     managed: false
     parameters:
       - 'allow-update { key "ddns-key"; }'
   zone_vmlab_lan:
     name: 'vmlab.lan'
     type: forward
     forwarders: ['172.30.0.11','172.30.0.12']
   zone_home:
     name: 'home'
     type: master
     managed: true
     content: "{{ zone_home }}"
   zone_10_99_1_rev:
     name: "1.99.10.in-addr.arpa"
     type: forward
     forwarders: ['172.30.0.11','172.30.0.12']
   zone_10_99_2_rev:
     name: "2.99.10.in-addr.arpa"
     type: forward
     forwarders: ['172.30.0.11','172.30.0.12']
   zone_172_30_0_rev:
     name: "0.30.172.in-addr.arpa"
     type: master
     managed: true
     content: "{{ zone_172_30_0_rev }}"
   zone_172_30_1_rev:
     name: "1.30.172.in-addr.arpa"
     type: master
     managed: true
     content: "{{ zone_172_30_1_rev }}"
   zone_172_31_2_rev:
     name: "2.31.172.in-addr.arpa"
     type: master
     managed: true
     content: "{{ zone_172_31_2_rev }}"
   zone_172_31_1_rev:
     name: "1.31.172.in-addr.arpa"
     type: master
     managed: true
     content: "{{ zone_172_31_1_rev }}"
   zone_172_31_1_static_rev:
     name: "static.1.31.172.in-addr.arpa"
     type: master
     managed: true
     content: "{{ zone_172_31_1_static_rev }}"
   zone_172_31_1_dhcp_rev:
     name: "dhcp.1.31.172.in-addr.arpa"
     type: master
     managed: false
     dynamic: true
     parameters:
       - 'allow-update { key "ddns-key"; }'
   zone_rzp_static_dhcp:
     name: "rzp-static-dhcp"
     type: master
     managed: true
     dynamic: false
     content: "{{ zone_rzp_static_dhcp }}"
     parameters:
       - 'allow-query { none; }'
